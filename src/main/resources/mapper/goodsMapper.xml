<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.seckill.seckill.dao.GoodsMapper">
    <select id="selectGoods" resultType="com.seckill.seckill.vo.GoodsVo">
        select g.id, name, price, stock, description, image, seckill_price, seckill_stock, start_time, end_time
        from goods g
        left join seckill_goods sg
        on g.id = sg.goods_id
        and sg.end_time &gt; now()
        limit #{offset}, #{limit}
        ;
    </select>

    <select id="selectGoodsById" resultType="com.seckill.seckill.vo.GoodsVo">
        select g.id, name, price, stock, description, image, seckill_price, seckill_stock, start_time, end_time
        from goods g
        left join seckill_goods sg
        on g.id = sg.goods_id
        and sg.start_time &gt; now()
        where g.id = #{id}
        ;
    </select>

    <select id="selectGoodsRows">
        select count(distinct id)
        from goods
        ;
    </select>

    <update id="updateSeckillGoodsStock">
        update seckill_goods
        set seckill_stock = seckill_stock + #{stock}
        where goods_id = #{goodsId}
        ;
    </update>
</mapper>